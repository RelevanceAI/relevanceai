<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>relevanceai.api.documents &mdash; Relevance AI 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Relevance AI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../viz.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core_api.html">Core RelevanceAI Specs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">relevanceai</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Relevance AI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>relevanceai.api.documents</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for relevanceai.api.documents</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">requests.models</span> <span class="kn">import</span> <span class="n">stream_decode_response_unicode</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">relevanceai.base</span> <span class="kn">import</span> <span class="n">Base</span>

<div class="viewcode-block" id="Documents"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents">[docs]</a><span class="k">class</span> <span class="nc">Documents</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">base_url</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">base_url</span><span class="p">)</span>

<div class="viewcode-block" id="Documents.list"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">select_fields</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">cursor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
        <span class="n">include_vector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve documents from a specified dataset. Cursor is provided to retrieve even more documents. Loop through it to retrieve all documents in the dataset. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_id : string</span>
<span class="sd">            Unique name of dataset</span>
<span class="sd">        select_fields : list</span>
<span class="sd">            Fields to include in the search results, empty array/list means all fields. </span>
<span class="sd">        page_size: int</span>
<span class="sd">            Size of each page of results</span>
<span class="sd">        cursor: string</span>
<span class="sd">            Cursor to paginate the document retrieval</span>
<span class="sd">        include_vector: bool</span>
<span class="sd">            Include vectors in the search results</span>
<span class="sd">        random_state: int</span>
<span class="sd">            Random Seed for retrieving random documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_http_request</span><span class="p">(</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/documents/list&quot;</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;select_fields&quot;</span><span class="p">:</span> <span class="n">select_fields</span><span class="p">,</span>
                <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
                <span class="s2">&quot;page_size&quot;</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span>
                <span class="s2">&quot;include_vector&quot;</span><span class="p">:</span> <span class="n">include_vector</span><span class="p">,</span>
                <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="n">random_state</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Documents.get"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">include_vector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a document by its ID (&quot;_id&quot; field). This will retrieve the document faster than a filter applied on the &quot;_id&quot; field. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_id : string</span>
<span class="sd">            Unique name of dataset</span>
<span class="sd">        id : list</span>
<span class="sd">            ID of a document in a dataset.</span>
<span class="sd">        include_vector: bool</span>
<span class="sd">            Include vectors in the search results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_http_request</span><span class="p">(</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/documents/get&quot;</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                <span class="s2">&quot;include_vector&quot;</span><span class="p">:</span> <span class="n">include_vector</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Documents.get_where"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.get_where">[docs]</a>    <span class="k">def</span> <span class="nf">get_where</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filters</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">cursor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">select_fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">include_vector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">is_random</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Retrieve documents with filters. Cursor is provided to retrieve even more documents. Loop through it to retrieve all documents in the database. Filter is used to retrieve documents that match the conditions set in a filter query. This is used in advance search to filter the documents that are searched. \n</span>

<span class="sd">        The filters query is a json body that follows the schema of:</span>

<span class="sd">        &gt;&gt;&gt; [</span>
<span class="sd">        &gt;&gt;&gt;    {&#39;field&#39; : &lt;field to filter&gt;, &#39;filter_type&#39; : &lt;type of filter&gt;, &quot;condition&quot;:&quot;==&quot;, &quot;condition_value&quot;:&quot;america&quot;},</span>
<span class="sd">        &gt;&gt;&gt;    {&#39;field&#39; : &lt;field to filter&gt;, &#39;filter_type&#39; : &lt;type of filter&gt;, &quot;condition&quot;:&quot;&gt;=&quot;, &quot;condition_value&quot;:90},</span>
<span class="sd">        &gt;&gt;&gt; ]</span>

<span class="sd">        These are the available filter_type types: [&quot;contains&quot;, &quot;category&quot;, &quot;categories&quot;, &quot;exists&quot;, &quot;date&quot;, &quot;numeric&quot;, &quot;ids&quot;] \n</span>

<span class="sd">        &quot;contains&quot;: for filtering documents that contains a string</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;item_brand&#39;, &#39;filter_type&#39; : &#39;contains&#39;, &quot;condition&quot;:&quot;==&quot;, &quot;condition_value&quot;: &quot;samsu&quot;}</span>

<span class="sd">        &quot;exact_match&quot;/&quot;category&quot;: for filtering documents that matches a string or list of strings exactly.</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;item_brand&#39;, &#39;filter_type&#39; : &#39;category&#39;, &quot;condition&quot;:&quot;==&quot;, &quot;condition_value&quot;: &quot;sumsung&quot;}</span>

<span class="sd">        &quot;categories&quot;: for filtering documents that contains any of a category from a list of categories.</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;item_category_tags&#39;, &#39;filter_type&#39; : &#39;categories&#39;, &quot;condition&quot;:&quot;==&quot;, &quot;condition_value&quot;: [&quot;tv&quot;, &quot;smart&quot;, &quot;bluetooth_compatible&quot;]}</span>

<span class="sd">        &quot;exists&quot;: for filtering documents that contains a field.</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;purchased&#39;, &#39;filter_type&#39; : &#39;exists&#39;, &quot;condition&quot;:&quot;==&quot;, &quot;condition_value&quot;:&quot; &quot;}</span>

<span class="sd">        If you are looking to filter for documents where a field doesn&#39;t exist, run this:</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;purchased&#39;, &#39;filter_type&#39; : &#39;exists&#39;, &quot;condition&quot;:&quot;!=&quot;, &quot;condition_value&quot;:&quot; &quot;}</span>

<span class="sd">        &quot;date&quot;: for filtering date by date range.</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;insert_date_&#39;, &#39;filter_type&#39; : &#39;date&#39;, &quot;condition&quot;:&quot;&gt;=&quot;, &quot;condition_value&quot;:&quot;2020-01-01&quot;}</span>

<span class="sd">        &quot;numeric&quot;: for filtering by numeric range.</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;price&#39;, &#39;filter_type&#39; : &#39;numeric&#39;, &quot;condition&quot;:&quot;&gt;=&quot;, &quot;condition_value&quot;:90}</span>

<span class="sd">        &quot;ids&quot;: for filtering by document ids.</span>

<span class="sd">        &gt;&gt;&gt; {&#39;field&#39; : &#39;ids&#39;, &#39;filter_type&#39; : &#39;ids&#39;, &quot;condition&quot;:&quot;==&quot;, &quot;condition_value&quot;:[&quot;1&quot;, &quot;10&quot;]}</span>

<span class="sd">        These are the available conditions:</span>

<span class="sd">        &gt;&gt;&gt; &quot;==&quot;, &quot;!=&quot;, &quot;&gt;=&quot;, &quot;&gt;&quot;, &quot;&lt;&quot;, &quot;&lt;=&quot;</span>
<span class="sd">        </span>
<span class="sd">        If you are looking to combine your filters with multiple ORs, simply add the following inside the query {&quot;strict&quot;:&quot;must_or&quot;}.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_id : string</span>
<span class="sd">            Unique name of dataset</span>
<span class="sd">        select_fields : list</span>
<span class="sd">            Fields to include in the search results, empty array/list means all fields.</span>
<span class="sd">        cursor: string</span>
<span class="sd">            Cursor to paginate the document retrieval</span>
<span class="sd">        page_size: int</span>
<span class="sd">            Size of each page of results</span>
<span class="sd">        include_vector: bool</span>
<span class="sd">            Include vectors in the search results</span>
<span class="sd">        sort: list</span>
<span class="sd">            Fields to sort by. For each field, sort by descending or ascending. If you are using descending by datetime, it will get the most recent ones.</span>
<span class="sd">        filters: list</span>
<span class="sd">            Query for filtering the search results</span>
<span class="sd">        is_random: bool</span>
<span class="sd">            If True, retrieves doucments randomly. Cannot be used with cursor.</span>
<span class="sd">        random_state: int</span>
<span class="sd">            Random Seed for retrieving random documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_http_request</span><span class="p">(</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/documents/get_where&quot;</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;select_fields&quot;</span><span class="p">:</span> <span class="n">select_fields</span><span class="p">,</span>
                <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
                <span class="s2">&quot;page_size&quot;</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span>
                <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">,</span>
                <span class="s2">&quot;include_vector&quot;</span><span class="p">:</span> <span class="n">include_vector</span><span class="p">,</span>
                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
                <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="n">random_state</span><span class="p">,</span>
                <span class="s2">&quot;is_random&quot;</span><span class="p">:</span> <span class="n">is_random</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Documents.bulk_update"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.bulk_update">[docs]</a>    <span class="k">def</span> <span class="nf">bulk_update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">updates</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_documents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Edits documents by providing a key value pair of fields you are adding or changing, make sure to include the &quot;_id&quot; in the documents.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_id : string</span>
<span class="sd">            Unique name of dataset</span>
<span class="sd">        updates : list</span>
<span class="sd">            Updates to make to the documents. It should be specified in a format of {&quot;field_name&quot;: &quot;value&quot;}. e.g. {&quot;item.status&quot; : &quot;Sold Out&quot;}</span>
<span class="sd">        insert_date	: bool</span>
<span class="sd">            Whether to include insert date as a field &#39;insert_date_&#39;.</span>
<span class="sd">        include_updated_ids	: bool</span>
<span class="sd">            Include the inserted IDs in the response</span>
<span class="sd">    </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">return_documents</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_http_request</span><span class="p">(</span>
                <span class="n">endpoint</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/documents/bulk_update&quot;</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="n">updates</span><span class="p">},</span>
                <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">,</span>
                <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://ingest-api-dev-aueast.relevance.ai/latest/&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">insert_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_http_request</span><span class="p">(</span>
                <span class="n">endpoint</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/documents/bulk_update&quot;</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="n">updates</span><span class="p">},</span>
                <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">,</span>
                <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://ingest-api-dev-aueast.relevance.ai/latest/&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">response_json</span> <span class="o">=</span> <span class="n">insert_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">response_json</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;response_json&quot;</span><span class="p">:</span> <span class="n">response_json</span><span class="p">,</span>
                <span class="s2">&quot;documents&quot;</span><span class="p">:</span> <span class="n">updates</span><span class="p">,</span>
                <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="n">insert_response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
            <span class="p">}</span></div>

<div class="viewcode-block" id="Documents.bulk_delete"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.bulk_delete">[docs]</a>    <span class="k">def</span> <span class="nf">bulk_delete</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">ids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Delete a list of documents by their IDs. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_id : string</span>
<span class="sd">            Unique name of dataset</span>
<span class="sd">        ids : list</span>
<span class="sd">            IDs of documents to delete</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_http_request</span><span class="p">(</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/documents/bulk_delete&quot;</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="n">ids</span><span class="p">},</span>
            <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Documents.get_where_all"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.get_where_all">[docs]</a>    <span class="k">def</span> <span class="nf">get_where_all</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="n">filters</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">select_fields</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">include_vector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve all documents with filters. Filter is used to retrieve documents that match the conditions set in a filter query. This is used in advance search to filter the documents that are searched. For more details see documents.get_where.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_id : string</span>
<span class="sd">            Unique name of dataset</span>
<span class="sd">        chunk_size : list</span>
<span class="sd">            Number of documents to retrieve per retrieval</span>
<span class="sd">        include_vector: bool</span>
<span class="sd">            Include vectors in the search results</span>
<span class="sd">        sort: list</span>
<span class="sd">            Fields to sort by. For each field, sort by descending or ascending. If you are using descending by datetime, it will get the most recent ones.</span>
<span class="sd">        filters: list</span>
<span class="sd">            Query for filtering the search results</span>
<span class="sd">        select_fields : list</span>
<span class="sd">            Fields to include in the search results, empty array/list means all fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialise values</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">full_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># While there is still data to fetch, fetch it at the latest cursor</span>
        <span class="k">while</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_where</span><span class="p">(</span>
                <span class="n">dataset_id</span><span class="p">,</span>
                <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
                <span class="n">cursor</span><span class="o">=</span><span class="n">cursor</span><span class="p">,</span>
                <span class="n">page_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
                <span class="n">select_fields</span><span class="o">=</span><span class="n">select_fields</span><span class="p">,</span>
                <span class="n">include_vector</span><span class="o">=</span><span class="n">include_vector</span><span class="p">,</span>
                <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;documents&quot;</span><span class="p">])</span>
            <span class="n">cursor</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;cursor&quot;</span><span class="p">]</span>

            <span class="c1"># Append fetched data to the full data</span>
            <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">full_data</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;documents&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">full_data</span></div>

<div class="viewcode-block" id="Documents.get_number_of_documents"><a class="viewcode-back" href="../../../relevanceai.api.html#relevanceai.api.documents.Documents.get_number_of_documents">[docs]</a>    <span class="k">def</span> <span class="nf">get_number_of_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">list_of_filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get number of documents in a multiple different dataset. Filter can be used to select documents that match the conditions set in a filter query. For more details see documents.get_where.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_ids: list</span>
<span class="sd">            Unique names of datasets</span>
<span class="sd">        list_of_filters: list </span>
<span class="sd">            List of list of filters to select documents in the same order of the dataset_ids list</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">list_of_filters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">list_of_filters</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_ids</span><span class="p">))]</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="n">dataset_id</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_number_of_documents</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">filters</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataset_ids</span><span class="p">,</span> <span class="n">list_of_filters</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="k">def</span> <span class="nf">_get_number_of_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get number of documents in a dataset. Filter can be used to select documents that match the conditions set in a filter query. For more details see documents.get_where.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_ids: list</span>
<span class="sd">            Unique names of datasets</span>
<span class="sd">        filters: list </span>
<span class="sd">            Filters to select documents</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_where</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Relevance AI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>